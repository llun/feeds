(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[484],{346:(e,t,a)=>{"use strict";a.d(t,{Page:()=>T});var r=a(5155),s=a(2115),l=a(5695),i=a(8605);class n{async getCategories(){let e=await fetch("".concat(this.basePath,"/categories.json"));if(200!==e.status)throw Error("Fail to load categories");return(await e.json()).map(e=>({title:e.name,totalEntries:e.totalEntries,sites:e.sites.map(e=>({key:e.siteHash,title:e.title,totalEntries:e.totalEntries}))}))}async getCategoryEntries(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];let t=await fetch("".concat(this.basePath,"/categories/").concat(e,".json"));if(200!==t.status)throw Error("Fail to load category entries");return(await t.json()).map(e=>({key:e.entryHash,title:e.title,site:{key:e.siteHash,title:e.siteTitle},timestamp:Math.floor(e.date/1e3)}))}async getSiteEntries(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];let t=await fetch("".concat(this.basePath,"/sites/").concat(e,".json"));if(200!==t.status)throw Error("Fail to load site entries");return(await t.json()).entries.map(e=>({key:e.entryHash,title:e.title,site:{key:e.siteHash,title:e.siteTitle},timestamp:Math.floor(e.date/1e3)}))}async countAllEntries(){let e=await fetch("".concat(this.basePath,"/categories.json"));if(200!==e.status)throw Error("Fail to load count all entries");return(await e.json()).reduce((e,t)=>e+t.totalEntries,0)}async countSiteEntries(e){let t=await fetch("".concat(this.basePath,"/sites/").concat(e,".json"));if(200!==t.status)throw Error("Fail to load site entries");return(await t.json()).entries.length}async countCategoryEntries(e){let t=await fetch("".concat(this.basePath,"/categories/").concat(e,".json"));if(200!==t.status)throw Error("Fail to load category entries");return(await t.json()).length}async getAllEntries(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let e=await fetch("".concat(this.basePath,"/all.json"));if(200!==e.status)throw Error("Fail to load all entries");return(await e.json()).map(e=>({key:e.entryHash,title:e.title,site:{key:e.siteHash,title:e.siteTitle},timestamp:Math.floor(e.date/1e3)}))}async getContent(e){let t=await fetch("".concat(this.basePath,"/entries/").concat(e,".json"));if(200!==t.status)throw Error("Fail to load content");let a=await t.json();return{title:a.title,content:a.content,url:a.link,siteKey:a.siteHash,siteTitle:a.siteTitle,timestamp:Math.floor(a.date/1e3)}}constructor(e){this.basePath="".concat(e,"/data")}}var c=a(3660);let o=null,d=e=>(!o&&(o=new n(e)),o);var h=a(2355);let u=e=>{let{onClickBack:t}=e;return(0,r.jsxs)("button",{onClick:t,className:"md:hidden inline-flex items-center text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 mr-3","aria-label":"Go back",children:[(0,r.jsx)(h.A,{className:"h-5 w-5 mr-1"})," Back"]})},x=e=>{let{basePath:t,title:a,locationState:l,selectSite:n,selectEntry:c,selectBack:o}=e,[h,x]=(0,s.useState)("loading"),[y,g]=(0,s.useState)(""),[m,f]=(0,s.useState)([]),[b,k]=(0,s.useState)(0),[p,j]=(0,s.useState)(""),[w,v]=(0,s.useState)(0),N=(0,s.useRef)(null),E=(0,s.useRef)(null),S=null,C=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=d(e);switch(t.type){case"category":{let e=t.category,[s,l]=await Promise.all([r.getCategoryEntries(e,a),r.countCategoryEntries(e)]);return{entries:s,totalEntry:l}}case"site":{let{siteKey:e}=t,[s,l]="all"===e?await Promise.all([r.getAllEntries(a),r.countAllEntries()]):await Promise.all([r.getSiteEntries(e,a),r.countSiteEntries(e)]);return{entries:s,totalEntry:l}}case"entry":let{parent:s}=t,{key:l}=s;if("category"===s.type){let[e,t]=await Promise.all([r.getCategoryEntries(l,a),r.countCategoryEntries(l)]);return{entries:e,totalEntry:t}}let[i,n]="all"===l?await Promise.all([r.getAllEntries(a),r.countAllEntries()]):await Promise.all([r.getSiteEntries(l,a),r.countSiteEntries(l)]);return{entries:i,totalEntry:n}}},A=async e=>{if("loading"===h||m.length===b)return;let{entries:a}=await C(t,l,e);f(m.concat(a))},P=(e,t)=>{if(j(e),t){let t=globalThis.document.querySelector("#entry-".concat(e));null==t||t.scrollIntoView({block:"center",inline:"start"})}c&&c(T,z,e)};(0,s.useEffect)(()=>{if("entry"!==l.type)switch(l.type){case"category":if(y===l.category)return;return g(l.category);case"site":if(y===l.siteKey)return;return g(l.siteKey)}},[l]),(0,s.useEffect)(()=>{S&&(async e=>{let{entries:a,totalEntry:r}=await C(t,l);x("loaded"),f(a),k(r),v(0),e.scrollTo(0,0)})(S)},[y,S]),(0,s.useEffect)(()=>{if(!(null==E?void 0:E.current))return;let e=new IntersectionObserver(e=>{let[t]=e;"loading"!==h&&t.isIntersecting&&(x("loading"),A(w+1).then(()=>{v(e=>e+1),x("loaded")}))});return e.observe(E.current),()=>{e.disconnect()}},[E,b,m]),(0,s.useEffect)(()=>{let e=e=>{switch(e.code){case"ArrowUp":case"KeyW":{if(e.preventDefault(),!p){P(m[0].key);return}let t=m.findIndex(e=>e.key===p);if(t<=0)return;P(m[t-1].key,!0);return}case"ArrowDown":case"KeyS":{if(e.preventDefault(),!p){P(m[0].key);return}let t=m.findIndex(e=>e.key===p);if(t>=m.length-1)return;P(m[t+1].key,!0);return}}};return globalThis.document.addEventListener("keydown",e),()=>{globalThis.document.removeEventListener("keydown",e)}},[m,p]);let T="entry"===l.type?l.parent.type:l.type,z="entry"===l.type?l.parent.key:"category"===l.type?l.category:l.siteKey;return(0,r.jsxs)("section",{className:"border-r border-gray-200 dark:border-gray-700 h-full overflow-hidden flex flex-col",children:[(0,r.jsxs)("div",{className:"sticky top-0 z-10 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700",children:[(0,r.jsx)("div",{className:"md:hidden p-4 border-b border-gray-200 dark:border-gray-700",children:(0,r.jsx)(u,{onClickBack:o})}),(0,r.jsx)("div",{className:"p-4",ref:e=>{S=e},children:(0,r.jsx)("h2",{className:"text-lg font-semibold line-clamp-2",children:a})})]}),(0,r.jsx)("div",{className:"overflow-y-auto flex-1",children:"loading"===h?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center h-96 p-4",children:[(0,r.jsx)("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-blue-500 rounded-full animate-spin mb-4"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-center",children:"Loading items..."})]}):m.length>0?(0,r.jsx)("ul",{ref:N,className:"divide-y divide-gray-200 dark:divide-gray-700",children:m.map((e,t)=>(0,r.jsx)("li",{id:"entry-".concat(e.key),className:"py-2 px-3 hover:bg-gray-50 dark:hover:bg-gray-800 ".concat(e.key===p?"bg-gray-100 dark:bg-gray-800":""),ref:m.length-5===t&&m.length<b?E:null,children:(0,r.jsxs)("div",{className:"w-full pr-2",children:[(0,r.jsx)("button",{children:(0,r.jsx)("h3",{onClick:()=>{P(e.key)},className:"font-medium text-sm text-left ".concat(e.key===p?"text-blue-700 dark:text-blue-500":""),children:e.title})}),(0,r.jsxs)("div",{className:"flex items-center mt-1 whitespace-nowrap",children:[(0,r.jsx)("button",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium hover:text-blue-600 dark:hover:text-blue-400 truncate",onClick:()=>{null==n||n(e.site.key)},children:e.site.title}),(0,r.jsx)("span",{className:"mx-1 text-gray-400 dark:text-gray-500 text-xs",children:"â€¢"}),(0,r.jsx)("span",{className:"text-xs text-gray-400 dark:text-gray-500 text-nowrap",children:(0,i.B)(1e3*e.timestamp,new Date,{addSuffix:!0})})]})]})},e.key))}):(0,r.jsxs)("div",{className:"p-4 text-center text-gray-500",children:[(0,r.jsx)("p",{children:"No items to display."}),(0,r.jsx)("p",{className:"text-sm",children:"Select a category or site from the left panel."})]})})]})};var y=a(8042);let g=e=>{let{content:t,selectBack:a}=e,l=null;return((0,s.useEffect)(()=>{l&&l.scrollTo(0,0)},[t]),t)?(0,r.jsxs)("article",{className:"h-full overflow-hidden flex flex-col",children:[(0,r.jsxs)("div",{className:"sticky top-0 z-10 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700",children:[(0,r.jsx)("div",{className:"md:hidden p-4 border-b border-gray-200 dark:border-gray-700",children:(0,r.jsx)(u,{onClickBack:a})}),(0,r.jsxs)("div",{className:"p-6 pb-3",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:t.title}),(0,r.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:[(0,r.jsxs)("span",{children:["Published:"," ",(0,i.B)(1e3*t.timestamp,new Date,{addSuffix:!0})]}),(0,r.jsx)("span",{className:"mx-2",children:"|"}),(0,r.jsx)("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"hover:text-blue-600 dark:hover:text-blue-400",children:"View Original"})]})]})]}),(0,r.jsx)("div",{className:"p-6 pt-4 prose dark:prose-invert lg:prose-xl max-w-full overflow-y-auto flex-1",ref:e=>{l=e},children:(0,y.Ay)(t.content,{replace:e=>(e.attribs&&"a"===e.name&&(e.attribs.target="_blank",e.attribs.rel="noopener noreferrer"),e)})})]}):(0,r.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400 p-8 text-center",children:(0,r.jsx)("p",{children:"Select an item from the list to view its content."})})};var m=a(6766),f=a(1362),b=a(2098),k=a(3509),p=a(2148);let j=()=>{let{theme:e,setTheme:t}=(0,f.D)(),[a,l]=(0,s.useState)(!1);return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("button",{onClick:()=>l(!a),className:"flex items-center border rounded-md p-1.5 dark:border-gray-700","aria-label":"Toggle theme",children:(()=>{switch(e){case"light":return(0,r.jsx)(b.A,{size:16});case"dark":return(0,r.jsx)(k.A,{size:16});default:return(0,r.jsx)(p.A,{size:16})}})()}),a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>l(!1)}),(0,r.jsx)("div",{className:"absolute right-0 mt-2 z-20 bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-md shadow-lg p-2",children:(0,r.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,r.jsxs)("button",{onClick:()=>{t("light"),l(!1)},className:"flex items-center space-x-2 p-2 rounded-sm hover:bg-gray-100 dark:hover:bg-gray-700 ".concat("light"===e?"bg-gray-200 dark:bg-gray-700":""),"aria-label":"Light mode",children:[(0,r.jsx)(b.A,{size:16}),(0,r.jsx)("span",{children:"Light"})]}),(0,r.jsxs)("button",{onClick:()=>{t("dark"),l(!1)},className:"flex items-center space-x-2 p-2 rounded-sm hover:bg-gray-100 dark:hover:bg-gray-700 ".concat("dark"===e?"bg-gray-200 dark:bg-gray-700":""),"aria-label":"Dark mode",children:[(0,r.jsx)(k.A,{size:16}),(0,r.jsx)("span",{children:"Dark"})]}),(0,r.jsxs)("button",{onClick:()=>{t("system"),l(!1)},className:"flex items-center space-x-2 p-2 rounded-sm hover:bg-gray-100 dark:hover:bg-gray-700 ".concat("system"===e?"bg-gray-200 dark:bg-gray-700":""),"aria-label":"System preference",children:[(0,r.jsx)(p.A,{size:16}),(0,r.jsx)("span",{children:"System"})]})]})})]})]})},w=e=>{let{categories:t,totalEntries:a,selectCategory:l,selectSite:i}=e,[n,c]=(0,s.useState)();return(0,r.jsxs)("nav",{className:"space-y-4 p-4 border-r border-gray-200 dark:border-gray-700 h-full overflow-y-auto",children:[(0,r.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"inline-flex items-center",children:[(0,r.jsx)(m.default,{src:"/logo.svg",alt:"RSS Feed Icon",width:32,height:32,className:"dark:invert",priority:!0}),(0,r.jsx)("h1",{className:"text-xl font-bold ml-2",children:"FEEDS"})]}),(0,r.jsx)(j,{})]}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)("button",{onClick:()=>{null==i||i("all","All Items")},className:"block font-medium hover:text-blue-600 dark:hover:text-blue-400",children:["All Items",(0,r.jsxs)("span",{className:"ml-2 text-xs text-gray-500 dark:text-gray-400",children:["(",null!=a?a:0,")"]})]})}),t.map(e=>(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("button",{onClick:()=>{c(e.title),null==l||l(e.title)},className:"block font-medium hover:text-blue-600 dark:hover:text-blue-400 text-left ".concat(e.title===n?"text-blue-700 dark:text-blue-500":""),children:[e.title,(0,r.jsxs)("span",{className:"ml-2 text-xs text-gray-500 dark:text-gray-400",children:["(",e.totalEntries,")"]})]}),n===e.title&&(0,r.jsx)("ul",{className:"ml-4 mt-2 space-y-1",children:e.sites.map(e=>(0,r.jsx)("li",{children:(0,r.jsxs)("button",{onClick:()=>{null==i||i(e.key,e.title)},className:"block text-sm text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 text-left",children:[e.title,(0,r.jsxs)("span",{className:"ml-2 text-xs text-gray-500 dark:text-gray-400",children:["(",e.totalEntries,")"]})]})},e.key))})]},e.title)),!t.length&&(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"No categories found."})]})},v=e=>"article"===e?"block":"hidden md:block",N=e=>"entries"===e?"md:block":"hidden md:block",E=e=>{switch(e){case"article":case"entries":return"hidden md:block";default:return"md:block"}},S=e=>{let t=e.split("/");if(t.shift(),![2,4].includes(t.length))return null;if(2===t.length){if(!t[1].trim())return null;switch(t[0]){case"categories":return{type:"category",category:t[1]};case"sites":return{type:"site",siteKey:t[1]};default:return null}}return t[3].trim()&&["categories","sites"].includes(t[0])&&"entries"===t[2]?{type:"entry",entryKey:t[3],parent:{type:"categories"===t[0]?"category":"site",key:t[1]}}:null},C=async(e,t,a,r)=>{if(!e)return null;let s=d(t);switch(e.type){case"category":case"site":a(null),r("entries");return;case"entry":{let{entryKey:t}=e,l=await s.getContent(t);if(!l)return;a(l),r("article");return}}},A=e=>({type:"UPDATE_PATH",value:e}),P=(e,t)=>{if("UPDATE_PATH"===t.type){let a=t.value;if(a===e.pathname)return e;let r=S(a);return window.history.pushState({location:r},"",a),{...e,pathname:a,location:r}}return e},T=()=>{let[e,t]=(0,s.useState)("loading"),[a,i]=(0,s.useState)("categories"),[n,c]=(0,s.useState)([]),[o,h]=(0,s.useState)(""),[u,y]=(0,s.useState)(null),[m,f]=(0,s.useState)(null),b=(0,l.useRouter)(),k=(0,l.usePathname)(),[p,j]=(0,s.useReducer)(P,{pathname:k,location:S(k)});return((0,s.useEffect)(()=>{(async()=>{if(!p.location){j(A("/sites/all"));return}if("loading"===e){let e=d("/feeds"),[a,r]=await Promise.all([e.getCategories(),e.countAllEntries()]);f(r),c(a),t("loaded")}await C(p.location,p.pathname,y,i)})();let a=e=>{j(A(k))};return window.addEventListener("popstate",a),()=>{window.removeEventListener("popstate",a)}},[e,p,b]),(0,s.useEffect)(()=>{var e;let t=d("/feeds");switch(null===(e=p.location)||void 0===e?void 0:e.type){case"category":h(p.location.category);break;case"site":if("all"===p.location.siteKey){h("All Items");break}t.getSiteEntries(p.location.siteKey).then(e=>{0!==e.length&&h(e[0].site.title)});break;case"entry":if("category"===p.location.parent.type){h(p.location.parent.key);break}t.getSiteEntries(p.location.parent.key).then(e=>{0!==e.length&&h(e[0].site.title)});break;default:h("All Items")}},[p]),"loading"===e)?(0,r.jsx)("div",{className:"fixed inset-0 bg-white dark:bg-gray-900 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 border-4 border-gray-300 border-t-blue-500 rounded-full animate-spin mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-lg font-semibold",children:"Loading content..."}),(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"This will take a few seconds"})]})}):(0,r.jsxs)("main",{className:"flex flex-col md:flex-row h-screen",children:[(0,r.jsx)("div",{className:"w-full md:w-1/4 xl:w-1/5 flex-shrink-0 ".concat(E(a)),children:(0,r.jsx)(w,{categories:n,totalEntries:m,selectCategory:e=>{h(e),j(A("/categories/".concat(e)))},selectSite:(e,t)=>{h(t),j(A("/sites/".concat(e)))}})}),(0,r.jsx)("div",{className:"w-full md:w-1/3 xl:w-2/5 flex-shrink-0 ".concat(N(a)),children:o?(0,r.jsx)(x,{basePath:p.pathname,locationState:p.location,title:o,selectBack:()=>i("categories"),selectSite:e=>{j(A("/sites/".concat(e)))},selectEntry:(e,t,a)=>{j(A("/".concat("category"===e?"categories":"sites","/").concat(t,"/entries/").concat(a)))}}):(0,r.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400 p-8 text-center border-r border-gray-200 dark:border-gray-700",children:(0,r.jsx)("p",{children:"Select a category or site from the left panel to see feed items."})})}),(0,r.jsx)("div",{className:"w-full flex-1 ".concat(u?"":"hidden md:block"," ").concat(v(a)),children:(0,r.jsx)(g,{content:u,selectBack:()=>{let e=p.location;if("entry"!==e.type)return;let{parent:t}=e,{type:a,key:r}=t;j(A("/".concat("category"===a?"categories":"sites","/").concat(r)))}})})]})}},4484:(e,t,a)=>{Promise.resolve().then(a.bind(a,346))}}]);